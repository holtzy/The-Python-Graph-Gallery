{"componentChunkName":"component---src-pages-jupyter-notebook-slug-js","path":"/sankey-diagram-with-python-and-plotly/","result":{"data":{"jupyterNotebook":{"html":"<div class=\"notebook-render\"><div class=\"sc-fqkvVR cbsNYc\"><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>The Data</h2></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>What kind of data do we need</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>source </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>target </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">3</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">4</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">4</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>value </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">4</span><span class=\"token\" style=\"color:#393A34\">]</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Most basic Sankey diagram with <code>Plotly</code></h2></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Once that we have the data, the first step is to load the library</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span><span> plotly</span><span class=\"token\" style=\"color:#393A34\">.</span><span>graph_objects </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> go</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Now let&#x27;s use it to plot the Sanke</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span>link </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span>source </span><span class=\"token\" style=\"color:#393A34\">=</span><span> source</span><span class=\"token\" style=\"color:#393A34\">,</span><span> target </span><span class=\"token\" style=\"color:#393A34\">=</span><span> target</span><span class=\"token\" style=\"color:#393A34\">,</span><span> value </span><span class=\"token\" style=\"color:#393A34\">=</span><span> value</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>data </span><span class=\"token\" style=\"color:#393A34\">=</span><span> go</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Sankey</span><span class=\"token\" style=\"color:#393A34\">(</span><span>link </span><span class=\"token\" style=\"color:#393A34\">=</span><span> link</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>fig </span><span class=\"token\" style=\"color:#393A34\">=</span><span> go</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Figure</span><span class=\"token\" style=\"color:#393A34\">(</span><span>data</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>show</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-kAyceB eLJVsY nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"></div></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Note that you can save this chart to a standalone file thanks to the write.html() function. It is then possible to render it in any html document using an <code>iframe</code></p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># If you need to save this file as a standalong html file:</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>write_html</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;../../static/interactiveCharts/sankey-diagram-plotly1.html&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#393A34\">%</span><span class=\"token\" style=\"color:#393A34\">%</span><span>html\n</span><span></span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span>iframe src</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;../../interactiveCharts/sankey-diagram-plotly1.html&quot;</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;800&quot;</span><span> height</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;600&quot;</span><span> title</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;ridgeline chart with plotly&quot;</span><span> style</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;border:none&quot;</span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span class=\"token\" style=\"color:#393A34\">/</span><span>iframe</span><span class=\"token\" style=\"color:#393A34\">&gt;</span></code></pre></div><div class=\"sc-kAyceB eLJVsY nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><iframe src=\"../../interactiveCharts/sankey-diagram-plotly1.html\" width=\"800\" height=\"600\" title=\"ridgeline chart with plotly\" style=\"border:none\"></iframe>\n</div></div></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Basic customization</h2></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>This section needs to be edited. Sorry for the inconvenience 😔</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><h2>Real life Sankey diagram</h2></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>This is the example coming from the <a href=\"https://plotly.com/python/sankey-diagram/\">plotly documentation</a>, in order to see how plotly behaves with a real life dataset!</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#0000ff\">import</span><span> plotly</span><span class=\"token\" style=\"color:#393A34\">.</span><span>graph_objects </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> go\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> urllib</span><span class=\"token\" style=\"color:#393A34\">,</span><span> json\n</span>\n<span>url </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;https://raw.githubusercontent.com/plotly/plotly.js/master/test/image/mocks/sankey_energy.json&#x27;</span><span>\n</span><span>response </span><span class=\"token\" style=\"color:#393A34\">=</span><span> urllib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>request</span><span class=\"token\" style=\"color:#393A34\">.</span><span>urlopen</span><span class=\"token\" style=\"color:#393A34\">(</span><span>url</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>data </span><span class=\"token\" style=\"color:#393A34\">=</span><span> json</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loads</span><span class=\"token\" style=\"color:#393A34\">(</span><span>response</span><span class=\"token\" style=\"color:#393A34\">.</span><span>read</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># override gray link colors with &#x27;source&#x27; colors</span><span>\n</span><span>opacity </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.4</span><span>\n</span><span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># change &#x27;magenta&#x27; to its &#x27;rgba&#x27; value to add opacity</span><span>\n</span><span>data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;node&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;rgba(255,0,255, 0.8)&#x27;</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> color </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;magenta&quot;</span><span> </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> color </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> color </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;node&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;node&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span>src</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>replace</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;0.8&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span>opacity</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>                                    </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> src </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;source&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span>fig </span><span class=\"token\" style=\"color:#393A34\">=</span><span> go</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Figure</span><span class=\"token\" style=\"color:#393A34\">(</span><span>data</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>go</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Sankey</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    valueformat </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;.0f&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    valuesuffix </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;TWh&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Define nodes</span><span>\n</span><span>    node </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      pad </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">15</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      thickness </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">15</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      line </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span>color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;black&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.5</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      label </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;node&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;label&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;node&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># Add links</span><span>\n</span><span>    link </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">dict</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      source </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;source&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      target </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;target&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      value </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;value&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      label </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;label&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color </span><span class=\"token\" style=\"color:#393A34\">=</span><span>  data</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;data&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;link&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>update_layout</span><span class=\"token\" style=\"color:#393A34\">(</span><span>title_text</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;Energy forecast for 2050&lt;br&gt;Source: Department of Energy &amp; Climate Change, Tom Counsell via &lt;a href=&#x27;https://bost.ocks.org/mike/sankey/&#x27;&gt;Mike Bostock&lt;/a&gt;&quot;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                  font_size</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-kAyceB eLJVsY nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"></div></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Save the figure in html format</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># If you need to save this file as a standalong html file:</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>write_html</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&quot;../../static/interactiveCharts/sankey-diagram-plotly-real.html&quot;</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-jXbUNg gqRgKk markdown\"><p>Render it as an iframe</p></div></div><div class=\"sc-eqUAAy jevAiY cell\" style=\"box-shadow:none\"><div class=\"sc-gsFSXq eSaGKB input-container\"><pre class=\"sc-iGgWBj gcBMNR input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#393A34\">%</span><span class=\"token\" style=\"color:#393A34\">%</span><span>html\n</span><span></span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span>iframe src</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;../../interactiveCharts/sankey-diagram-plotly-real.html&quot;</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;800&quot;</span><span> height</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;900&quot;</span><span> title</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;ridgeline chart with plotly&quot;</span><span> style</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&quot;border:none&quot;</span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span class=\"token\" style=\"color:#393A34\">/</span><span>iframe</span><span class=\"token\" style=\"color:#393A34\">&gt;</span></code></pre></div><div class=\"sc-kAyceB eLJVsY nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><iframe src=\"../../interactiveCharts/sankey-diagram-plotly-real.html\" width=\"800\" height=\"600\" title=\"ridgeline chart with plotly\" style=\"border:none\"></iframe>\n</div></div></div></div></div></div>","metadata":{"title":"Sankey Diagram with Python and Plotly","description":"This blogpost describes how to build a Sankey Diagram with <code>Python</code> and the <code>Plotly</code> library. It starts with basic examples based on various input formats and then explain how to apply the most common customisations.","seoDescription":"same as description but shorter","family":"flow","chartType":"sankey","keywords":"python, chart, plot, seaborn, matplotlib, kdeplot","slug":"sankey-diagram-with-python-and-plotly"}}},"pageContext":{"id":"d6815ac4-52e6-5c9f-bdf3-6cc8a8343750 >>> JupyterNotebook","slug":"sankey-diagram-with-python-and-plotly","__params":{"slug":"sankey-diagram-with-python-and-plotly"}}},"staticQueryHashes":["2944911273"],"slicesMap":{}}