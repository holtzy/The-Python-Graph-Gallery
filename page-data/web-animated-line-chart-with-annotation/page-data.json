{"componentChunkName":"component---src-pages-jupyter-notebook-slug-js","path":"/web-animated-line-chart-with-annotation/","result":{"data":{"jupyterNotebook":{"html":"<div class=\"notebook-render\"><div class=\"sc-fLDLck copmGR\"><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>About</h2>\n<p>This plot is an <strong>animation</strong> that displays the evolution of objects launched in outer space by the USA and Russia between 1958 and 2023. It has been made for the #TidyTuesday challenge.</p>\n<p>The chart was made by <a href=\"https://www.barbierjoseph.com/\">Joseph B</a> with <a href=\"/matplotlib\">matplotlib</a>. Thanks to him for accepting sharing his work here!</p>\n<p>Let&#x27;s see what the final picture will look like:</p>\n<p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text8.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Libraries</h2>\n<p>First, you need to load a whole bunch of libraries:</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># data manipulation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> pandas </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> pd\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> numpy </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> np\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># visualization</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> matplotlib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>pyplot </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> plt\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> highlight_text </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> ax_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fig_text\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># animation</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> PIL </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> Image</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ImageSequence\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> textwrap\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">import</span><span> math\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">from</span><span> matplotlib</span><span class=\"token\" style=\"color:#393A34\">.</span><span>animation </span><span class=\"token\" style=\"color:#0000ff\">import</span><span> FuncAnimation</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Dataset</h2>\n<p>For this reproduction, we&#x27;re going to retrieve the data directly from the gallery&#x27;s Github repo. This means we just need to <strong>give the right url as an argument</strong> to pandas&#x27; <code>read_csv()</code> function to retrieve the data.</p>\n<p>Then, we apply a few simple modifications to the data in order to have <strong>1 row per year</strong>, with 2 columns: the number of outer space object for the US and for the Russia.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># Open the dataset from Github</span><span>\n</span><span>url </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;https://raw.githubusercontent.com/holtzy/the-python-graph-gallery/master/static/data/space_objects.csv&quot;</span><span>\n</span>\n<span>df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pd</span><span class=\"token\" style=\"color:#393A34\">.</span><span>read_csv</span><span class=\"token\" style=\"color:#393A34\">(</span><span>url</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">[</span><span>df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Entity&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">!=</span><span class=\"token\" style=\"color:#A31515\">&#x27;World&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">[</span><span>df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Code&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>isin</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;RUS&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>sort_values</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># pivot data</span><span>\n</span><span>pivot_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>pivot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>index</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> columns</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;Code&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> values</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;num_objects&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>dropna</span><span class=\"token\" style=\"color:#393A34\">(</span><span>inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_reference </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>copy</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># save for later annotation</span><span>\n</span>\n<span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>head</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-kfeOyU hdFmYB nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Code</th>\n      <th>RUS</th>\n      <th>USA</th>\n    </tr>\n    <tr>\n      <th>Year</th>\n      <th></th>\n      <th></th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>1958</th>\n      <td>1.0</td>\n      <td>7.0</td>\n    </tr>\n    <tr>\n      <th>1959</th>\n      <td>3.0</td>\n      <td>11.0</td>\n    </tr>\n    <tr>\n      <th>1960</th>\n      <td>3.0</td>\n      <td>17.0</td>\n    </tr>\n    <tr>\n      <th>1961</th>\n      <td>7.0</td>\n      <td>31.0</td>\n    </tr>\n    <tr>\n      <th>1962</th>\n      <td>20.0</td>\n      <td>55.0</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p>Now we have a dataset that fits perfectly the needs for this animation!</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Minimalist animation</h2>\n<p>Let&#x27;s start with the most simple animation possible.</p>\n<p>The <code>update()</code> function is designed to <strong>update the contents of the plot</strong> for each animation frame. It uses the <code>frame</code> argument which is simply the index (a number) of the row in the dataset.</p>\n<p><code>subset_df = pivot_df.iloc[:frame]</code> <strong>slices</strong> the DataFrame pivot_df to get data <strong>up to the current</strong> frame number</p>\n<p>Then, the <code>FuncAnimation()</code> function is used to <strong>create the animation</strong> by repeatedly calling the <code>update()</code> function.</p>\n<p>Finally, we save it using the <code>save()</code> function.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text.gif&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Colors and static annotations</h2>\n<p>Now, let&#x27;s add some colors and static annotations to the plot.</p>\n<p>We create a <code>colors</code> list, which will then be used for the annotations and the chart. You can <strong>change the values</strong> inside it and it will <strong>automatically</strong> update the colors of the annotations.</p>\n<p>Annotations are added using the <code>highlight_text</code> package and its <code>ax_text()</code> and <code>fig_text()</code> functions. You can learn more about it <a href=\"/advanced-custom-annotations-matplotlib\">in this post</a>.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text2.gif&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text2.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Axis and scale</h2>\n<p>In the previous output, we can see some <strong>overlapping</strong> between the annotations and the chart.</p>\n<p>In order to fix this, we will change the <strong>y-axis</strong> scale by multiplying its maximum value by <code>1.9</code>. This will create a <strong>large empty space</strong> that will give more room for the annotations coming.</p>\n<p>We also <strong>remove</strong> the <code>top</code> and <code>right</code> spines, as well as x-axis ticks and labels.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axis</span><span>\n</span><span>    factor_y_axis </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1.9</span><span>\n</span><span>    y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span>factor_y_axis\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text3.gif&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text3.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Text that appears throughout the animation</h2>\n<p>In order to have a text that is displayed <strong>throughout the animation</strong>, we need to find a way to define <strong>what part</strong> of the text we should display at each frame. Here is how it works:</p>\n<ol>\n<li><strong>Total Characters Calculation</strong>: It first calculates the total number of characters in the full description using <code>len(description)</code>, where <code>description</code> is the text we want to display.</li>\n<li><strong>Effective Frame Count</strong>: It determines the number of frames over which the text will appear, excluding the last 20 frames of the total number of frames in <code>pivot_df</code>. Exclude the last 20 frames to ensure the text is displayed for a reasonable amount of time and <strong>ends before</strong> the animation ends.</li>\n<li><strong>Characters per Frame</strong>: It calculates how many characters of the description should be displayed up to the current frame. If the current frame is before the end of the effective frame count, it shows a portion of the text proportional to the current frame number. If the current frame number is at or beyond the effective frame count, it shows the entire text.</li>\n<li><strong>Current Text</strong>: The script then extracts the portion of the description up to the calculated number of characters.</li>\n<li><strong>Text Wrapping</strong>: Finally, it wraps the text to ensure each line does not exceed 70 characters, which helps in making the text easy to read on screen. Each paragraph is processed separately to maintain paragraph breaks.</li>\n</ol>\n<p>In order to make the code cleaner, we define <strong>on top of the script</strong> values that will be then used in annotations and in the text that appears throughout the animation.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># reference values</span><span>\n</span><span>total </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>us_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>total</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span><span>rus_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">100</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> us_share\n</span><span>data_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">&gt;=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2012</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>us_share_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> data_after_2012</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>data_after_2012</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># important dates</span><span>\n</span><span>start_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1958</span><span>\n</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;Between </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">start_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> and </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">end_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">, the USA and Russia have launched in outer space a total of </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation token builtin\">int</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation token interpolation\">total</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">)</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> objects. The USA has launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of these objects, while the Russia has only launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">rus_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of them.\\n\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">After 2012, </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share_after_2012</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of the objects launched in outer space by the USA and Russia were from the USA, highlighting the increasing dominance of the USA in outer space exploration.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axis</span><span>\n</span><span>    factor_y_axis </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1.9</span><span>\n</span><span>    y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span>factor_y_axis\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>                </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>    text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">    &quot;&quot;&quot;</span><span>\n</span><span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>            </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>    total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>    effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># ends 20 frames before the end</span><span>\n</span><span>    num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>    current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>    wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">70</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>        </span><span class=\"token\" style=\"color:#36acaa\">0.157</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.72</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>        fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>    </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text4.gif&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text4.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Highlight events</h2>\n<p>Highlighting events in an animation is very powerful but can be a bit tricky and confusing. Here is how it works:</p>\n<ul>\n<li>we create a <code>annot_event()</code> function that takes multiple arguments: <code>current_date</code>, <code>event_start_date</code>, <code>event_end_date</code>, <code>adj</code> and <code>text</code>.</li>\n<li>with this information, we can find <strong>which event</strong> should be currently highlighted and display the corresponding text. The function will ensure that <strong>only one event</strong> is highlighted at a time.</li>\n<li>this function is then used in the <code>update()</code> function to display the event that is currently happening. In pratice a <code>for</code> loop is used on each event to test whether it should be highlighted or not. This makes very easy to <strong>add/remove</strong> new events in the future.</li>\n<li>the loop uses the <code>dates_highlight</code>, <code>event_end_dates</code>, <code>adjustements</code>, <code>event_texts</code> lists to get all the information needed to highlight the events, and those lists are defined at the beginning of the script.</li>\n</ul>\n<p>We also add the <strong>years in the background</strong> by using once again the <code>highlight_text</code> package. The code is right after:</p>\n<p><code># year annotation in background</code></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># reference values</span><span>\n</span><span>total </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>us_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>total</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span><span>rus_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">100</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> us_share\n</span><span>data_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">&gt;=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2012</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>us_share_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> data_after_2012</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>data_after_2012</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># important dates</span><span>\n</span><span>start_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1958</span><span>\n</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span><span>first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1961</span><span>\n</span><span>us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1969</span><span>\n</span><span>hubble_launch </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1990</span><span>\n</span><span>internat_space_station </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1998</span><span>\n</span><span>earth_size_found </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2017</span><span>\n</span><span>photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2019</span><span>\n</span><span>total_objects_today </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># delay for each event</span><span>\n</span><span>delay_years </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># to display the event one year after it happened</span><span>\n</span><span>dates_highlight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    hubble_launch </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    internat_space_station </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    earth_size_found </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>event_end_dates </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dates_highlight</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># position adjustments for each event</span><span>\n</span><span>adjustements </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">18</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">22</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">400</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># text to display for each event</span><span>\n</span><span>event_texts </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Human Spaceflight\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">first_human_spaceflight</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;US Moon Landing\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_moon_landing</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Hubble Launch\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">hubble_launch</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;International Space Station\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">internat_space_station</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Earth Size Planets found\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">earth_size_found</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Image of a Black Hole\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">photo_black_hole</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;Between </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">start_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> and </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">end_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">, the USA and Russia have launched in outer space a total of </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation token builtin\">int</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation token interpolation\">total</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">)</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> objects. The USA has launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of these objects, while the Russia has only launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">rus_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of them.\\n\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">After 2012, </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share_after_2012</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of the objects launched in outer space by the USA and Russia were from the USA, highlighting the increasing dominance of the USA in outer space exploration.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># functions use to annotate events with black lollipops</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># condition to only display one event at a time</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> event_start_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> current_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># filter on the current year</span><span>\n</span><span>      sub_subset </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>      total_objects_thisyear </span><span class=\"token\" style=\"color:#393A34\">=</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;RUS&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># plot lollipop</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate event</span><span>\n</span><span>      ax_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         event_start_date </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># x position</span><span>\n</span><span>         total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># y position</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ax</span><span class=\"token\" style=\"color:#393A34\">=</span><span>ax\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axis</span><span>\n</span><span>   factor_y_axis </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1.9</span><span>\n</span><span>   y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span>factor_y_axis\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># year annotation in background</span><span>\n</span><span>   year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.15</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#A31515\">&#x27;1958 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">50</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.1</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>   total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># ends 20 frames before the end</span><span>\n</span><span>   num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>   current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">70</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display description</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.157</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.72</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate events</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">zip</span><span class=\"token\" style=\"color:#393A34\">(</span><span>dates_highlight</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_dates</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adjustements</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_texts</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text5.gif&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text5.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Custom frame duration</h2>\n<p>Our current animation has a <strong>constant frame duration</strong>. This means that each frame is displayed for the same amount of time. However, a good animation might need to customize the duration of each frame.</p>\n<p>As far as I know, the easiest way to change it is to open the saved GIF, iterate over each frame, and change the duration of each frame. This is done using the <code>PIL</code> library.</p>\n<p>In our case, we want:</p>\n<ul>\n<li>the last 12 frames to become <strong>slower</strong> in order to give more time to understand the final message.</li>\n<li>the last frame to be displayed for <strong>10 seconds</strong>. so that the viewer has time to read the final message and have the big picture before the GIF restarts.</li>\n</ul>\n<p>The code is right after the <code>save()</code> function.</p>\n<p>We also take the opportunity to add a <strong>last frame</strong> annotation that will be displayed for 10 seconds. In the <code>update()</code> function we test if it&#x27;s the last frame, and if so, we display the final message.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># reference values</span><span>\n</span><span>total </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>us_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>total</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span><span>rus_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">100</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> us_share\n</span><span>data_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">&gt;=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2012</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>us_share_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> data_after_2012</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>data_after_2012</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># important dates</span><span>\n</span><span>start_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1958</span><span>\n</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span><span>first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1961</span><span>\n</span><span>us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1969</span><span>\n</span><span>hubble_launch </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1990</span><span>\n</span><span>internat_space_station </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1998</span><span>\n</span><span>earth_size_found </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2017</span><span>\n</span><span>photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2019</span><span>\n</span><span>total_objects_today </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># delay for each event</span><span>\n</span><span>delay_years </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># to display the event one year after it happened</span><span>\n</span><span>dates_highlight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    hubble_launch </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    internat_space_station </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    earth_size_found </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>event_end_dates </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dates_highlight</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># position adjustments for each event</span><span>\n</span><span>adjustements </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">18</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">22</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">400</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># text to display for each event</span><span>\n</span><span>event_texts </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Human Spaceflight\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">first_human_spaceflight</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;US Moon Landing\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_moon_landing</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Hubble Launch\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">hubble_launch</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;International Space Station\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">internat_space_station</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Earth Size Planets found\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">earth_size_found</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Image of a Black Hole\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">photo_black_hole</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;Between </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">start_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> and </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">end_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">, the USA and Russia have launched in outer space a total of </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation token builtin\">int</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation token interpolation\">total</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">)</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> objects. The USA has launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of these objects, while the Russia has only launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">rus_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of them.\\n\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">After 2012, </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share_after_2012</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of the objects launched in outer space by the USA and Russia were from the USA, highlighting the increasing dominance of the USA in outer space exploration.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># functions use to annotate events with black lollipops</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># condition to only display one event at a time</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> event_start_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> current_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># filter on the current year</span><span>\n</span><span>      sub_subset </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>      total_objects_thisyear </span><span class=\"token\" style=\"color:#393A34\">=</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;RUS&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># plot lollipop</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate event</span><span>\n</span><span>      ax_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         event_start_date </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># x position</span><span>\n</span><span>         total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># y position</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ax</span><span class=\"token\" style=\"color:#393A34\">=</span><span>ax\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axis</span><span>\n</span><span>   factor_y_axis </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1.9</span><span>\n</span><span>   y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span>factor_y_axis\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># year annotation in background</span><span>\n</span><span>   year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.15</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#A31515\">&#x27;1958 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">50</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.1</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>   total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># ends 20 frames before the end</span><span>\n</span><span>   num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>   current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">70</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display description</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.157</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.72</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display conclusion message on last frame</span><span>\n</span><span>   last_frame </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> last_frame</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      total_last </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      total_usa </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;USA&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      total_rus </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;RUS&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      Total Objects Launched in Outer Space in </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_objects_today</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &lt;USA&gt;: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_usa</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt; (</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_usa</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">/</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">*</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#36acaa\">100</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">%)\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &lt;Russia&gt;: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_rus</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt; (</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_rus</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">/</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">*</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#36acaa\">100</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">%)\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &quot;&quot;&quot;</span><span>\n</span><span>      fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#36acaa\">0.43</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.32</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">16</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate events</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">zip</span><span class=\"token\" style=\"color:#393A34\">(</span><span>dates_highlight</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_dates</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adjustements</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_texts</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>         annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text6.gif&#x27;</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get initial frames</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">with</span><span> Image</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> img</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    frames </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>copy</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> ImageSequence</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Iterator</span><span class=\"token\" style=\"color:#393A34\">(</span><span>img</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># set duration of each frame</span><span>\n</span><span>initial_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">for</span><span> i</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># default duration</span><span>\n</span><span>   frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># make last N frames becomes step by step slower</span><span>\n</span><span>   N </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">12</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> N</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>i </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> N</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># stay for last date</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10000</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># assign duration to the frame</span><span>\n</span><span>   frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>info</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;duration&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> frame_duration\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># save the frames</span><span>\n</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> save_all</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span><span> append_images</span><span class=\"token\" style=\"color:#393A34\">=</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> loop</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text6.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Speed, smoothing and resolution</h2>\n<p>The animation is now almost perfect. However, it currently lacks smoothing and a good speed. Actually those are <strong>highly related</strong>. The more frames you have, the <strong>smoother the animation will be</strong>, but the slower it will be as well.</p>\n<p>The solution to this is to interpolate the dataframe used, which basically means we&#x27;re going to create a lot of new rows in order to have a <strong>smoother animation</strong>. This is done with the <code>interpolate()</code> function from pandas.</p>\n<p>The following is a bit verbose because we want different smoothing throughout the animation. We want the years after 2018 to be <strong>very smooth</strong> in order to have a nice transition to the final message.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># interpolate for more data points</span><span>\n</span><span>multiple </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">5</span><span>\n</span><span>new_index </span><span class=\"token\" style=\"color:#393A34\">=</span><span> np</span><span class=\"token\" style=\"color:#393A34\">.</span><span>linspace</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">min</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">*</span><span> multiple</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#393A34\">(</span><span>multiple</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>reindex</span><span class=\"token\" style=\"color:#393A34\">(</span><span>new_index</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span>interpolate</span><span class=\"token\" style=\"color:#393A34\">(</span><span>method</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;linear&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>reset_index</span><span class=\"token\" style=\"color:#393A34\">(</span><span>inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rename</span><span class=\"token\" style=\"color:#393A34\">(</span><span>columns</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;index&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span> inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>astype</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>drop</span><span class=\"token\" style=\"color:#393A34\">(</span><span>columns</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">=</span><span> new_index\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># higher interpolate level after 2018</span><span>\n</span><span>pivot_df_before </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#36acaa\">2018</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>pivot_df_after </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">2018</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>multiple_end </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">15</span><span>\n</span><span>new_index_end </span><span class=\"token\" style=\"color:#393A34\">=</span><span> np</span><span class=\"token\" style=\"color:#393A34\">.</span><span>linspace</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">min</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">*</span><span> multiple_end</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#393A34\">(</span><span>multiple_end</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_after </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>reindex</span><span class=\"token\" style=\"color:#393A34\">(</span><span>new_index_end</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span>interpolate</span><span class=\"token\" style=\"color:#393A34\">(</span><span>method</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;linear&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>reset_index</span><span class=\"token\" style=\"color:#393A34\">(</span><span>inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rename</span><span class=\"token\" style=\"color:#393A34\">(</span><span>columns</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;index&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span> inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>astype</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>drop</span><span class=\"token\" style=\"color:#393A34\">(</span><span>columns</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;Year&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">=</span><span> new_index_end\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># combine data</span><span>\n</span><span>pivot_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pd</span><span class=\"token\" style=\"color:#393A34\">.</span><span>concat</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>pivot_df_before</span><span class=\"token\" style=\"color:#393A34\">,</span><span> pivot_df_after</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>drop_duplicates</span><span class=\"token\" style=\"color:#393A34\">(</span><span>inplace</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>tail</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div><div class=\"sc-kfeOyU hdFmYB nteract-outputs\" style=\"max-height:100%\"><div class=\"cell_display\" style=\"max-height:100%;overflow-y:auto\"><div><div>\n<style scoped>\n    .dataframe tbody tr th:only-of-type {\n        vertical-align: middle;\n    }\n\n    .dataframe tbody tr th {\n        vertical-align: top;\n    }\n\n    .dataframe thead th {\n        text-align: right;\n    }\n</style>\n<table border=\"1\" class=\"dataframe\">\n  <thead>\n    <tr style=\"text-align: right;\">\n      <th>Code</th>\n      <th>RUS</th>\n      <th>USA</th>\n    </tr>\n  </thead>\n  <tbody>\n    <tr>\n      <th>2022.946667</th>\n      <td>61.36</td>\n      <td>2153.893333</td>\n    </tr>\n    <tr>\n      <th>2022.960000</th>\n      <td>61.52</td>\n      <td>2156.920000</td>\n    </tr>\n    <tr>\n      <th>2022.973333</th>\n      <td>61.68</td>\n      <td>2159.946667</td>\n    </tr>\n    <tr>\n      <th>2022.986667</th>\n      <td>61.84</td>\n      <td>2162.973333</td>\n    </tr>\n    <tr>\n      <th>2023.000000</th>\n      <td>62.00</td>\n      <td>2166.000000</td>\n    </tr>\n  </tbody>\n</table>\n</div></div></div></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p>Now that we have updated our dataframe, we can run the same code as before to create the animation. The result is a <strong>much smoother</strong> animation.</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">30</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># reference values</span><span>\n</span><span>total </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>us_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>total</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span><span>rus_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">100</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> us_share\n</span><span>data_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">&gt;=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2012</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>us_share_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> data_after_2012</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>data_after_2012</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># important dates</span><span>\n</span><span>start_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1958</span><span>\n</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span><span>first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1961</span><span>\n</span><span>us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1969</span><span>\n</span><span>hubble_launch </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1990</span><span>\n</span><span>internat_space_station </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1998</span><span>\n</span><span>earth_size_found </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2017</span><span>\n</span><span>photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2019</span><span>\n</span><span>total_objects_today </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># delay for each event</span><span>\n</span><span>delay_years </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># to display the event one year after it happened</span><span>\n</span><span>dates_highlight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    hubble_launch </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    internat_space_station </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    earth_size_found </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>event_end_dates </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dates_highlight</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># position adjustments for each event</span><span>\n</span><span>adjustements </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">18</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">22</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">400</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># text to display for each event</span><span>\n</span><span>event_texts </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Human Spaceflight\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">first_human_spaceflight</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;US Moon Landing\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_moon_landing</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Hubble Launch\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">hubble_launch</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;International Space Station\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">internat_space_station</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Earth Size Planets found\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">earth_size_found</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Image of a Black Hole\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">photo_black_hole</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;Between </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">start_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> and </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">end_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">, the USA and Russia have launched in outer space a total of </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation token builtin\">int</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation token interpolation\">total</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">)</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> objects. The USA has launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of these objects, while the Russia has only launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">rus_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of them.\\n\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">After 2012, </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share_after_2012</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of the objects launched in outer space by the USA and Russia were from the USA, highlighting the increasing dominance of the USA in outer space exploration.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># functions use to annotate events with black lollipops</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># condition to only display one event at a time</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> event_start_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> current_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># filter on the current year</span><span>\n</span><span>      sub_subset </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>      total_objects_thisyear </span><span class=\"token\" style=\"color:#393A34\">=</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;RUS&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># plot lollipop</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate event</span><span>\n</span><span>      ax_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         event_start_date </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># x position</span><span>\n</span><span>         total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># y position</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ax</span><span class=\"token\" style=\"color:#393A34\">=</span><span>ax\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axis</span><span>\n</span><span>   factor_y_axis </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1.9</span><span>\n</span><span>   y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span>factor_y_axis\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># year annotation in background</span><span>\n</span><span>   year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.15</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#A31515\">&#x27;1958 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">50</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.1</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>   total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># ends 20 frames before the end</span><span>\n</span><span>   num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>   current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">70</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display description</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.157</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.72</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display conclusion message on last frame</span><span>\n</span><span>   last_frame </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> last_frame</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      total_last </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      total_usa </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;USA&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      total_rus </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;RUS&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      Total Objects Launched in Outer Space in </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_objects_today</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &lt;USA&gt;: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_usa</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt; (</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_usa</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">/</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">*</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#36acaa\">100</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">%)\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &lt;Russia&gt;: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_rus</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt; (</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_rus</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">/</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">*</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#36acaa\">100</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">%)\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &quot;&quot;&quot;</span><span>\n</span><span>      fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#36acaa\">0.43</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.32</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">16</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate events</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">zip</span><span class=\"token\" style=\"color:#393A34\">(</span><span>dates_highlight</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_dates</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adjustements</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_texts</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>         annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text7.gif&#x27;</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get initial frames</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">with</span><span> Image</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> img</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    frames </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>copy</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> ImageSequence</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Iterator</span><span class=\"token\" style=\"color:#393A34\">(</span><span>img</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># set duration of each frame</span><span>\n</span><span>initial_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">for</span><span> i</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># default duration</span><span>\n</span><span>   frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># make last N frames becomes step by step slower</span><span>\n</span><span>   N </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">12</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> N</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>i </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> N</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># stay for last date</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10000</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># assign duration to the frame</span><span>\n</span><span>   frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>info</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;duration&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> frame_duration\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># save the frames</span><span>\n</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> save_all</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span><span> append_images</span><span class=\"token\" style=\"color:#393A34\">=</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> loop</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text7.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Resolution</h2>\n<p>Now that we have built the chart with the result we want, we can <strong>increase the resolution</strong> for the final GIF. This is done by changing the <code>dpi</code> parameter at the beginning of the script.</p>\n<p>This can takes a <strong>few minutes</strong> to run (between ~5 to ~10 minutes for this case).</p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-gNZgCX hpSITR input-container\"><pre class=\"sc-jbAkgO hVUwg input\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none;padding:10px 0px 10px 10px;margin:0px;overflow:auto;border:none;background-color:var(--cm-background, #fafafa)\"><code class=\"language-python\" style=\"color:#393A34;font-family:&quot;Consolas&quot;, &quot;Bitstream Vera Sans Mono&quot;, &quot;Courier New&quot;, Courier, monospace;direction:ltr;text-align:left;white-space:pre;word-spacing:normal;word-break:normal;font-size:.9em;line-height:1.2em;-moz-tab-size:4;-o-tab-size:4;tab-size:4;-webkit-hyphens:none;-moz-hyphens:none;-ms-hyphens:none;hyphens:none\"><span class=\"token\" style=\"color:#008000;font-style:italic\"># control resolution (lower is faster)</span><span>\n</span><span>dpi </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">120</span><span>\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;figure.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span><span>plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>rcParams</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;savefig.dpi&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dpi\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># parameters</span><span>\n</span><span>colors </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;#2a9d8f&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#e76f51&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>background_color </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;#fef9ef&#x27;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># reference values</span><span>\n</span><span>total </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>us_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">,</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>total</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span><span>rus_share </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">100</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> us_share\n</span><span>data_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>pivot_df_reference</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index </span><span class=\"token\" style=\"color:#393A34\">&gt;=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2012</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>us_share_after_2012 </span><span class=\"token\" style=\"color:#393A34\">=</span><span> data_after_2012</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">/</span><span>data_after_2012</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">100</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># important dates</span><span>\n</span><span>start_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1958</span><span>\n</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span><span>first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1961</span><span>\n</span><span>us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1969</span><span>\n</span><span>hubble_launch </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1990</span><span>\n</span><span>internat_space_station </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1998</span><span>\n</span><span>earth_size_found </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2017</span><span>\n</span><span>photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2019</span><span>\n</span><span>total_objects_today </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2023</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># delay for each event</span><span>\n</span><span>delay_years </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># to display the event one year after it happened</span><span>\n</span><span>dates_highlight </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    first_human_spaceflight </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    us_moon_landing </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    hubble_launch </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    internat_space_station </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    earth_size_found </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    photo_black_hole </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>event_end_dates </span><span class=\"token\" style=\"color:#393A34\">=</span><span> dates_highlight</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>end_date </span><span class=\"token\" style=\"color:#393A34\">+</span><span> delay_years</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># position adjustments for each event</span><span>\n</span><span>adjustements </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">2</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">18</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">22</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span class=\"token\" style=\"color:#36acaa\">400</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># text to display for each event</span><span>\n</span><span>event_texts </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Human Spaceflight\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">first_human_spaceflight</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;US Moon Landing\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_moon_landing</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Hubble Launch\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">hubble_launch</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;International Space Station\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">internat_space_station</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;Earth Size Planets found\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">earth_size_found</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&#x27;First Image of a Black Hole\\n&lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">photo_black_hole</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;&#x27;</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description</span><span>\n</span><span>description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;Between </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">start_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> and </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">end_date</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">, the USA and Russia have launched in outer space a total of </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation token builtin\">int</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">(</span><span class=\"token string-interpolation token interpolation\">total</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">)</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\"> objects. The USA has launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of these objects, while the Russia has only launched </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">rus_share</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of them.\\n\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">After 2012, </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">us_share_after_2012</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">% of the objects launched in outer space by the USA and Russia were from the USA, highlighting the increasing dominance of the USA in outer space exploration.\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&quot;&quot;&quot;</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># create figure and axis</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span> ax </span><span class=\"token\" style=\"color:#393A34\">=</span><span> plt</span><span class=\"token\" style=\"color:#393A34\">.</span><span>subplots</span><span class=\"token\" style=\"color:#393A34\">(</span><span>figsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">12</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">8</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_facecolor</span><span class=\"token\" style=\"color:#393A34\">(</span><span>background_color</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># functions use to annotate events with black lollipops</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>current_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> text</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># condition to only display one event at a time</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> event_start_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> current_date </span><span class=\"token\" style=\"color:#393A34\">&lt;=</span><span> event_end_date</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># filter on the current year</span><span>\n</span><span>      sub_subset </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>      total_objects_thisyear </span><span class=\"token\" style=\"color:#393A34\">=</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;RUS&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> sub_subset</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;USA&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># plot lollipop</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>plot</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_start_date</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>scatter</span><span class=\"token\" style=\"color:#393A34\">(</span><span>event_start_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">,</span><span> color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> s</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">100</span><span class=\"token\" style=\"color:#393A34\">,</span><span> zorder</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate event</span><span>\n</span><span>      ax_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         event_start_date </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># x position</span><span>\n</span><span>         total_objects_thisyear</span><span class=\"token\" style=\"color:#393A34\">*</span><span class=\"token\" style=\"color:#36acaa\">1.2</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># y position</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ax</span><span class=\"token\" style=\"color:#393A34\">=</span><span>ax\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#0000ff\">def</span><span> </span><span class=\"token\" style=\"color:#393A34\">update</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>clear</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   subset_df </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>stackplot</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      subset_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>values</span><span class=\"token\" style=\"color:#393A34\">.</span><span>T</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      colors</span><span class=\"token\" style=\"color:#393A34\">=</span><span>colors\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># custom axis</span><span>\n</span><span>   factor_y_axis </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1.9</span><span>\n</span><span>   y_max </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>iloc</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">+</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span>axis</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">max</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">*</span><span>factor_y_axis\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_ylim</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span> y_max</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_xticks</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   ax</span><span class=\"token\" style=\"color:#393A34\">.</span><span>spines</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>set_visible</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#36acaa\">False</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># year annotation in background</span><span>\n</span><span>   year </span><span class=\"token\" style=\"color:#393A34\">=</span><span> pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>index</span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.15</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#A31515\">&#x27;1958 - &#x27;</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token builtin\">str</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token builtin\">round</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">50</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontweight</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      alpha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0.1</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># description of video</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Evolution of the number of object put in outer\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   space each year by the &lt;USA&gt; and the &lt;Russia&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.127</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.84</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">20</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span>colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># credit annotation</span><span>\n</span><span>   text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">&quot;&quot;&quot;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Developed by &lt;@joseph_barbier&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   Data Source: &lt;Office for Outer Space Affairs&gt;\n</span><span class=\"token triple-quoted-string\" style=\"color:#A31515\">   &quot;&quot;&quot;</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.9</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;right&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;bottom&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">7</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get text to display at current frame</span><span>\n</span><span>   total_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>description</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   effective_frame_count </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">20</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># ends 20 frames before the end</span><span>\n</span><span>   num_chars </span><span class=\"token\" style=\"color:#393A34\">=</span><span> math</span><span class=\"token\" style=\"color:#393A34\">.</span><span>ceil</span><span class=\"token\" style=\"color:#393A34\">(</span><span>total_chars </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>frame </span><span class=\"token\" style=\"color:#393A34\">/</span><span> effective_frame_count</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">&lt;</span><span> effective_frame_count </span><span class=\"token\" style=\"color:#0000ff\">else</span><span> total_chars\n</span><span>   current_description </span><span class=\"token\" style=\"color:#393A34\">=</span><span> description</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#393A34\">:</span><span>num_chars</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span><span>   wrapped_text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">.</span><span>join</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">[</span><span>textwrap</span><span class=\"token\" style=\"color:#393A34\">.</span><span>fill</span><span class=\"token\" style=\"color:#393A34\">(</span><span>paragraph</span><span class=\"token\" style=\"color:#393A34\">,</span><span> width</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">70</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> paragraph </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> current_description</span><span class=\"token\" style=\"color:#393A34\">.</span><span>split</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#A31515\">&#x27;\\n&#x27;</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display description</span><span>\n</span><span>   fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#36acaa\">0.157</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.72</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      wrapped_text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;left&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;top&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">14</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>      fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>   </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># display conclusion message on last frame</span><span>\n</span><span>   last_frame </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> frame </span><span class=\"token\" style=\"color:#393A34\">==</span><span> last_frame</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      total_last </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">sum</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      total_usa </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;USA&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      total_rus </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token builtin\">int</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">.</span><span>loc</span><span class=\"token\" style=\"color:#393A34\">[</span><span>total_objects_today</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&quot;RUS&quot;</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>      text </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token string-interpolation token\" style=\"color:#A31515\">f&quot;&quot;&quot;\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      Total Objects Launched in Outer Space in </span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_objects_today</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt;\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &lt;USA&gt;: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_usa</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt; (</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_usa</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">/</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">*</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#36acaa\">100</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">%)\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &lt;Russia&gt;: &lt;</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_rus</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">&gt; (</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">{</span><span class=\"token string-interpolation token interpolation\">total_rus</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">/</span><span class=\"token string-interpolation token interpolation\">total_last</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">*</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#36acaa\">100</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">:</span><span class=\"token string-interpolation token interpolation token format-spec\">.2f</span><span class=\"token string-interpolation token interpolation token\" style=\"color:#393A34\">}</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">%)\n</span><span class=\"token string-interpolation token\" style=\"color:#A31515\">      &quot;&quot;&quot;</span><span>\n</span><span>      fig_text</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#36acaa\">0.43</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#36acaa\">0.32</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         text</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         ha</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> va</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;center&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fontsize</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">16</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         color</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;black&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         highlight_textprops</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#393A34\">[</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;color&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> colors</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>               </span><span class=\"token\" style=\"color:#393A34\">{</span><span class=\"token\" style=\"color:#A31515\">&#x27;fontweight&#x27;</span><span class=\"token\" style=\"color:#393A34\">:</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;bold&#x27;</span><span class=\"token\" style=\"color:#393A34\">}</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         </span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>         fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig\n</span><span>      </span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">else</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>      </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># annotate events</span><span>\n</span><span>      </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">zip</span><span class=\"token\" style=\"color:#393A34\">(</span><span>dates_highlight</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_end_dates</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adjustements</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_texts</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>         annot_event</span><span class=\"token\" style=\"color:#393A34\">(</span><span>year</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> end_date</span><span class=\"token\" style=\"color:#393A34\">,</span><span> adj</span><span class=\"token\" style=\"color:#393A34\">,</span><span> event_text</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#0000ff\">return</span><span> ax\n</span>\n<span>ani </span><span class=\"token\" style=\"color:#393A34\">=</span><span> FuncAnimation</span><span class=\"token\" style=\"color:#393A34\">(</span><span>\n</span><span>    fig</span><span class=\"token\" style=\"color:#393A34\">=</span><span>fig</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    func</span><span class=\"token\" style=\"color:#393A34\">=</span><span>update</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    frames</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>pivot_df</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">,</span><span>\n</span><span>    interval</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">10</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span><span>path </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#A31515\">&#x27;../../static/animations/web-animation-with-text8.gif&#x27;</span><span>\n</span><span>ani</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> writer</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#A31515\">&#x27;imagemagick&#x27;</span><span class=\"token\" style=\"color:#393A34\">,</span><span> fps</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">5</span><span class=\"token\" style=\"color:#393A34\">)</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># get initial frames</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">with</span><span> Image</span><span class=\"token\" style=\"color:#393A34\">.</span><span class=\"token builtin\">open</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">as</span><span> img</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>    frames </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#393A34\">[</span><span>frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>copy</span><span class=\"token\" style=\"color:#393A34\">(</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#0000ff\">for</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> ImageSequence</span><span class=\"token\" style=\"color:#393A34\">.</span><span>Iterator</span><span class=\"token\" style=\"color:#393A34\">(</span><span>img</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">]</span><span>\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># set duration of each frame</span><span>\n</span><span>initial_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span> </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># in ms</span><span>\n</span><span></span><span class=\"token\" style=\"color:#0000ff\">for</span><span> i</span><span class=\"token\" style=\"color:#393A34\">,</span><span> frame </span><span class=\"token\" style=\"color:#0000ff\">in</span><span> </span><span class=\"token builtin\">enumerate</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># default duration</span><span>\n</span><span>   frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># make last N frames becomes step by step slower</span><span>\n</span><span>   N </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">12</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">&gt;</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> N</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> initial_duration </span><span class=\"token\" style=\"color:#393A34\">+</span><span> </span><span class=\"token\" style=\"color:#393A34\">(</span><span>i </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">+</span><span> N</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">*</span><span> </span><span class=\"token\" style=\"color:#36acaa\">50</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># stay for last date</span><span>\n</span><span>   </span><span class=\"token\" style=\"color:#0000ff\">if</span><span> i </span><span class=\"token\" style=\"color:#393A34\">==</span><span> </span><span class=\"token builtin\">len</span><span class=\"token\" style=\"color:#393A34\">(</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">)</span><span> </span><span class=\"token\" style=\"color:#393A34\">-</span><span> </span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span>\n</span><span>      frame_duration </span><span class=\"token\" style=\"color:#393A34\">=</span><span> </span><span class=\"token\" style=\"color:#36acaa\">10000</span><span>\n</span>\n<span>   </span><span class=\"token\" style=\"color:#008000;font-style:italic\"># assign duration to the frame</span><span>\n</span><span>   frame</span><span class=\"token\" style=\"color:#393A34\">.</span><span>info</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#A31515\">&#x27;duration&#x27;</span><span class=\"token\" style=\"color:#393A34\">]</span><span> </span><span class=\"token\" style=\"color:#393A34\">=</span><span> frame_duration\n</span>\n<span></span><span class=\"token\" style=\"color:#008000;font-style:italic\"># save the frames</span><span>\n</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">.</span><span>save</span><span class=\"token\" style=\"color:#393A34\">(</span><span>path</span><span class=\"token\" style=\"color:#393A34\">,</span><span> save_all</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">True</span><span class=\"token\" style=\"color:#393A34\">,</span><span> append_images</span><span class=\"token\" style=\"color:#393A34\">=</span><span>frames</span><span class=\"token\" style=\"color:#393A34\">[</span><span class=\"token\" style=\"color:#36acaa\">1</span><span class=\"token\" style=\"color:#393A34\">:</span><span class=\"token\" style=\"color:#393A34\">]</span><span class=\"token\" style=\"color:#393A34\">,</span><span> loop</span><span class=\"token\" style=\"color:#393A34\">=</span><span class=\"token\" style=\"color:#36acaa\">0</span><span class=\"token\" style=\"color:#393A34\">)</span></code></pre></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><p><img src=\"https://raw.githubusercontent.com/holtzy/The-Python-Graph-Gallery/master/static/animations/web-animation-with-text8.gif\" alt=\"gif\"/></p></div></div><div class=\"sc-dVBluf ikNWdq cell\" style=\"box-shadow:none\"><div class=\"sc-jBIHhB bMhvsO markdown\"><h2>Going further</h2>\n<p>This article explains how to reproduce <strong>an animation</strong> that displays the number of outer space objects launched by the US and Russia over the years. The animation is enriched with <strong>annotations</strong> that highlight important events and a text that appears throughout the animation.</p>\n<p>You might be interested in</p>\n<ul>\n<li>the <a href=\"/stacked-area-plot\">stacked area section</a></li>\n<li>the <a href=\"/animation\">animation section</a></li>\n</ul></div></div></div></div>","metadata":{"title":"Animation with text that highlights important events","description":"<p><strong>Animation</strong> serves as a dynamic medium for storytelling, and <a href='/matplotlib'><strong>Matplotlib</strong></a> offers specialized tools for this purpose.</p><p>In this tutorial, we'll craft an <a href='/animation'><strong>animation</strong></a> featuring a <a href='/stacked-area-plot'><strong>stacked area chart</strong></a>. It includes <strong>persistent text</strong> that underscores pivotal moments. Expect the final visualization to be adorned with precise annotations and stylish color choices.</p><p>This guide is structured to be a comprehensive walkthrough, complete with <strong>executable code</strong> that you can replicate.</p>","seoDescription":"How to create an animation of a stacked area chart with matplotlib that dislays a text throughout the animation and highlights important events.","family":"general","chartType":"animation","keywords":"animation, gif, area, matplotlib, stacked, stack, color, plot, chart, background, text","slug":"web-animated-line-chart-with-annotation"}}},"pageContext":{"id":"fdb59631-991c-5dc6-b517-a2fa1ced8035 >>> JupyterNotebook","slug":"web-animated-line-chart-with-annotation","__params":{"slug":"web-animated-line-chart-with-annotation"}}},"staticQueryHashes":["2944911273"],"slicesMap":{}}